<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 3.5  (Windows)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGED" CONTENT="20130218;9242067">
	<STYLE TYPE="text/css">
	<!--
		H2.cjk { font-family: "SimSun" }
		H2.ctl { font-family: "Mangal" }
		H3.western { font-family: "Albany", sans-serif }
		H3.cjk { font-family: "HG Mincho Light J" }
		H3.ctl { font-family: "Arial Unicode MS" }
		H4.western { font-family: "Albany", sans-serif; font-size: 11pt; font-style: italic }
		H4.cjk { font-family: "HG Mincho Light J"; font-size: 11pt; font-style: italic }
		H4.ctl { font-family: "Arial Unicode MS"; font-size: 11pt; font-style: italic }
	-->
	</STYLE>
</HEAD>
<BODY LANG="de-DE" DIR="LTR">
<H1>Solvis SC2 Viewer</H1>
<H2 CLASS="western"><A NAME="Installation"></A>Installation</H2>
<P>Voraussetzung für die Installation des Programms auf einem
Windows-System ist das .NET Framework 4.0. Falls es noch nicht auf
dem Rechner installiert ist, kann das .NET Framework 4.0 von der
Microsoft-Seite kostenfrei heruntergeladen
werden.<BR><A HREF="http://www.microsoft.com/netframework/">http://www.microsoft.com/netframework/</A><BR>Das
.NET Framework ist zuerst zu installieren. Danach erfolgt die
Installation des Programms mit der Datei SolvisSC2.msi (Doppelklick
im Explorer). Das Programm ist jetzt im Programmverzeichnis
Solvis\SolvisSC2 installiert. Über das Startmenu Programme\SolvisSC2
kann das Programm aufgerufen werden.</P>
<H2 CLASS="western"><A NAME="Configuration"></A>Konfiguration</H2>
<P>Über den Menupunkt „Extras-&gt;Konfiguration“ kann das
Programm für den Benutzer eingestellt werden. Für die
Logdaten-Anzeige können die Texte, Tooltip, Farbe und Sichtbarkeit
der Sensoren, Aktoren und Optionen angepasst werden. Hierzu wählt
man zuerst den passenden Tabulator an (Sensoren, Aktoren, Optionen).
Auf der linken Seite muß dann der zu ändernde Sensor, Aktor oder
Option angewählt werden. Dann können für dieses angewählte
Element die Werte verändert werden. Allerdings ist es bei den
Optionen nicht empfehlenswert die Texte zu verändern, da bei den
Optionen eine im Programm festgelegte Funktion dahintersteht
(Ausnahme: Freie Formeln). Bei einigen Optionen können die
relevanten Parameter eingestellt werden. Diese Parameter werden in
dem zusätzlichen Dialogfenster nach dem Betätigen von „OK“
direkt übernommen</P>
<P>Beispiel für Sensor S04:</P>
<P><IMG SRC="description_html_m5af52375.png" NAME="Grafik5" ALIGN=LEFT WIDTH=399 HEIGHT=366 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Beispiel für Option P04:</P>
<P><IMG SRC="description_html_17ed8846.png" NAME="Grafik4" ALIGN=LEFT WIDTH=397 HEIGHT=387 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Unter dem Tabulator „Heizkurve“ können die Grundwerte für
das Fenster eingestellt werden, welches über Extras-&gt;Heizkurve
aufgerufen wird.</P>
<P><IMG SRC="description_html_194401b9.png" NAME="Grafik6" ALIGN=LEFT WIDTH=398 HEIGHT=369 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Unter dem Tabulator „SD-Card“ können die Grundwerte für das
Zeitplan Fenster eingestellt werden, welches über Extras-&gt;SD-Card
Infos-&gt;Zeitplan aufgerufen wird. Das Dateiverzeichnis muß auf ein
Verzeichnis gesetzt werden, in dem sich die Dateien zeitplan.txt,
zaehlst.txt und paramact.txt befinden.</P>
<P><IMG SRC="description_html_63c54339.png" NAME="Grafik7" ALIGN=LEFT WIDTH=394 HEIGHT=369 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Mit dem „Defaults“-Schalter werden die im Programm
festgelegten Grundwerte aktiviert.<BR><BR>Die meisten Änderungen der
Konfiguration sind sofort wirksam. Nach Änderung einiger spezieller
Konfigurationseinstellungen (z.B. Freie Formeln) ist es allerdings
notwendig das Programm neu zu starten.<BR><BR>Nach dem Beenden des
Programms wird eine Konfigurationsdatei (User.config) angelegt. Der
Pfad für die User.config ist unterschiedlich bei verschiedenen
Betriebssystemen. <BR>Unter Windows XP lautet der Pfad „Dokumente
und Einstellungen\&lt;<I>UserName</I>&gt;\Anwendungsdaten\Solvis\SolvisViewer“.
<BR>Unter Windows Vista lautet der Pfad
„Benutzer\&lt;<I>UserName</I>&gt;\AppData\Roaming\Solvis\SolvisViewer“.<BR><BR>Die
User.config ist eine Xml-Datei. Alternativ kann auch diese Datei mit
einem Xml-Editor oder einem normalen (UTF8 fähigen) Texteditor
bearbeitet werden.Über die Xml-Datei können Text, ToolTip,
Aktivierzustand (Checked), Sichtbarkeit (Visible), Farbe (ColorRGB)
der Sensoren S01 bis S24, der Aktoren A01 bis A20 und den Optionen
P01 bis P08 angepasst werden.<BR>Checked und Visible können auf die
Werte „true“ oder „false“ gesetzt werden. Bei ColorRGB wird
ein RGB-Wert (Rot, Grün, Blau-Anteil) eingestellt. Jeder der drei
durch Komma getrennten Werte kann im Bereich 0 bis 255 liegen. Der
Wert 0,0,0 entspricht Schwarz, 255,255,255 entspricht Weiß.</P>
<P>Im Xml-Tag „OpenDir“ ist der Pfad für das Öffnen der
Solvis-Datei hinterlegt.<BR>Im Xml-Tag „Version“ ist die aktuelle
Programmversion hinterlegt.<BR>In BurnerMinPower (Brenner minimale
Leistung) und BurnerMaxPower (Brenner maximale Leistung) können die
Werte für den Brenner eingestellt werden.</P>
<P>In Latitude und Longitude können die eigenen geografischen
Koordinaten eingestellt werden für die Darstellung des Sonnenstands.</P>
<P>In Temperature, Niveau und Gradient werden die Startwerte für die
Heizkurve eingestellt.<BR>Temperature darf nur ganzzahlig im Bereich
12 bis 28,<BR>Niveau darf nur ganzzahlig im Bereich -5 bis
+5,<BR>Gradient darf nur in 0.05 Schritten im Bereich 0.50 bis
2.00<BR>vorgegeben werden.</P>
<P>In TemperatureVL, NiveauVL und GradientVL werden die Werte der
Heizungs-Anlage eingestellt. Diese Werte dienen der Bestimmung der
Abweichung der Vorlauftemperatur des ersten Heizkreises.</P>
<P><B>Achtung: </B><SPAN STYLE="font-weight: normal">Die Werte mit
Nachkommastellen müssen in der User.config Datei mit einem Punkt
eingegeben werden (z.B. 7.5).<BR>Bei Falscheingabe wird eine Datei
StackTrace.txt im oben genannten Verzeichnis erzeugt.</SPAN></P>
<P>Beim jedem neuen Programmstart werden die aktuellen Werte aus der
User.config Datei verwendet.</P>
<P><B>Xml-Editor:</B> z.B. Xml Notepad 2007 von Microsoft</P>
<P><A HREF="http://www.microsoft.com/download/en/details.aspx?id=7973">http://www.microsoft.com/download/en/details.aspx?id=7973</A></P>
<P><BR><BR>
</P>
<H2 CLASS="western"><A NAME="HeatCurve"></A>Heizkurve</H2>
<P>Durch Anwählen des Menupunkts Extras/Heizkurve wird ein neues
Fenster geöffnet für die Darstellung von drei parametrierbaren
Heizkurven. Hierbei zeigen die ersten beiden Kurven (Curve1 und
Curve2) den echten von Solvis realisierten Verlauf der Heizkurve. Der
Verlauf ist geprägt durch eine Rundung auf ganze Grad für die
Vorlauf-Temperatur. Man sieht aber auch deutlich den Versatz bei
negativen Außentemperaturen. Die dritte Kurve zeigt einen
idealisierten Verlauf der Kurve (Ideal), wie sie in der Solvis
Beschreibung L30 dargestellt ist. Für alle Kurven kann die
Raum-Solltemperatur (Temperature) (Display Heizkreismenu, Seite 3),
Steilheit (Gradient) (Heizkreismenu, Seite 2) und Niveau
(Thermometersymbol im Heizungsmenu) vorgegeben werden.</P>
<P><B>Anmerkung des Verfassers:</B> &lt;Den Parameter „Niveau“
hätte ich auch im Heizkreismenu erwartet. Das Thermometersymbol wäre
nur zur (additiven) Feinregulierung des „Niveaus“ notwendig.<BR>Aber
es gibt zumindest eine getrennte Einstellung des „Niveaus“ für
jeden Heizkreis über das Thermometersymbol im Heizungsmenu.&gt;</P>
<P>Durch Variation der im unteren Teil des Fensters verfügbaren
Parameter wird der Einfluss in der Heizkurve grafisch sichtbar
gemacht. Somit kann man relativ leicht beurteilen, wie sich die
Änderungen von Parametern auswirken. Über den Menupunkt „Drucken“
kann eine Druckvorschau (PrintPreview) oder ein Druck (Print)
ausgelöst werden.</P>
<P>Mit dem Menupunkt „Konfiguration“ können die
Berechnungsverfahren der Kurven verändert werden. Der obere Teil in
dem aufgeklappten Menu ist für die Kurve1 (Curve1), während der
untere Teil für die Kurve2 zuständig ist. Ohne Anwahl einer der
Menupunkte wird der Originalverlauf der Solvis Control 2
dargestellt.<BR>Mit dem Aktivieren von „floor“, „round“ oder
„nicht gerundet“ für Curve1 bzw. Curve2 wird die bei Solvis
verwendete Formel mit unterschiedlichen Rundungsverfahren
dargestellt. Der Verfasser ist der Meinung, dass die alternativen
Berechnungs-Modelle besser geeignet wären für die Bestimmung der
Heizkurve und der Idealkurve am nächsten kämen, wenn man die
Mischersteuerung mit ganzen Grad-Zahlen durchführen muss. Nach
eigenen Beobachtungen kämen die „round“ oder „nicht gerundet“
Formel der Realität am nächsten. Zusätzlich müsste nach Ansicht
des Verfassers aber auch eine Betrachtung über VL Ist und VL Soll
über einen angemessenen Zeitraum in der „Solvis Control 2“
stattfinden. Die aufgetretenen Abweichungen in dem zugrunde liegenden
Zeitraum könnte die „Solvis Control 2“ durch zusätzlichen
Eingriff in die Mischersteuerung korrigieren.</P>
<P>Die zugrunde liegende Basis-Formel lautet:<BR>VL = k1 * G * (RT –
AT)**k2 + RT + N<BR>Hierbei sind<BR>VL = Vorlauftemperatur<BR>k1, k2
= Konstanten<BR>G = Gradient oder Steilheit<BR>RT = Raumtemperatur<BR>AT
= Aussentemperatur<BR>N = Niveau<BR>k1 wurde mit dem Wert 1.8207 und
k2 mit 0.8 angenommen. Die tatsächlichen Werte, die Solvis verwendet
hat, können geringfügig abweichen.</P>
<H3 CLASS="western">Formeln in der Programmiersprache C dargestellt:</H3>
<P>Floor-Formel: VL = (int)(k1 * G * pow(RT – floor(AT), k2) + RT +
N);</P>
<P>Round-Formel: VL = round(k1 * G * pow(RT – round(AT * 2) / 2,
k2) + RT + N);<BR>Hinweis: Die Round-Formel rundet auf halbe Grad für
die Aussentemperatur.</P>
<P>nicht gerundet-Formel: VL = round(k1 * G * pow(RT – AT, k2) + RT
+ N);</P>
<P>wahrscheinliche Solvis-Formel: VL = (int)(k1 * G * pow(RT –
(int)(AT), k2) + RT + N);<BR><BR>Da round keine Standardfunktion in
der C-Bibliothek ist, muss sie folgendermassen definiert werden:<BR>int
round(double value) {<BR>if (value &gt;= 0.0)<BR>return (int)(value +
0.5);<BR>else<BR>return (int)(value - 0.5);<BR>}</P>
<P>Im Internet findet man diverse Vorgehensweisen für die Bestimmung
von optimalen Heizkurven. z.B.</P>
<P><A HREF="http://www.shk-mayer.de/Page/Waermeerzeuger/Heizkurve.html">http://www.shk-mayer.de/Page/Waermeerzeuger/Heizkurve.html</A></P>
<P><A HREF="http://www.moria.de/~michael/haus/energie/heizkurve.html">http://www.moria.de/~michael/haus/energie/heizkurve.html</A></P>
<H2 CLASS="western"><A NAME="Optimize"></A>Optimale Heizkurve
(Vorlauftemp.) einstellen</H2>
<P STYLE="margin-bottom: 0cm">Um die optimale Heizkurve für den
niedrigsten Energieverbrauch einstellen zu können, ist eine
komplette Heizperiode erforderlich. Erforderlich für die Bestimmung
der Heizkurve sind unterschiedliche Aussentemperaturen. Zu beachten
ist auch die Empfehlung von Solvis für die Montage des
Aussentemperatur-Fühlers.</P>
<P STYLE="margin-bottom: 0cm">Bei der Solvis-Control 2 hat man für
die Einstellung der Heizkurve drei Parameter zur Verfügung.</P>
<OL STYLE="margin-left: 0.64cm">
	<LI><P STYLE="margin-bottom: 0cm">Raum-Soll-Temperatur
	(Heizkreismenu, Seite 3)</P>
	<LI><P STYLE="margin-bottom: 0cm">Niveau: Im Menu Heizung ist dies
	der Schaltwippen-Wert des Thermometersymbols.</P>
	<LI><P STYLE="margin-bottom: 0cm">Steilheit der Heizkurve:
	(Heizkreismenu, Seite 2)</P>
</OL>
<P STYLE="margin-bottom: 0cm"><BR>Bei der Einstellung der Parameter
für die Vorlauftemperatur sollte man folgendermassen vorgehen (ohne
Raumfühler):</P>
<UL STYLE="margin-left: 0.64cm">
	<LI><P STYLE="margin-bottom: 0cm">Heizkörperventile voll aufdrehen
	(Heizkörper sollten hydraulisch abgeglichen sein).</P>
</UL>
<UL STYLE="margin-left: 0.64cm">
	<LI><P STYLE="margin-bottom: 0cm">gewünschte Temperatur (z.B. 21
	Grad) im Heizkreismenu, Seite 3 als Raum-Solltemperatur einstellen.</P>
	<LI><P STYLE="margin-bottom: 0cm">Einen Grundwert für die Steilheit
	einstellen (z.B. 1,2 ) im Heizkreismenu, Seite 2. Es sollte die
	Empfehlung aus der Solvis-Beschreibung bzw. des Heizungsbetriebs
	berücksichtigt werden für die Festlegung des Grundwertes.</P>
	<LI><P STYLE="margin-bottom: 0cm">Dann den Niveau Parameter so
	eingestellen, das sich eine Temperatur von ungefähr 21 Grad in den
	Räumen ergibt. Ein bis zwei Tage Wartezeit sind erforderlich nach
	jeder Änderung.</P>
	<LI><P STYLE="margin-bottom: 0cm">Bei einigermassen gleichmässigen
	Aussentemperaturen ist die zugehörige Soll Vorlauf-Temperatur
	tabellarisch zu notieren. Der Aussentemperatur Mittelwert und die
	Soll Vorlauf-Temperatur können im Heizkreismenu, Seite 4 und 5 für
	die Tabelle abgelesen werden. Unter Umständen sind jetzt Niveau
	bzw. Steilheit in kleinen Schritten anzupassen, so dass die
	Temperatur in den Räumen stimmt.</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>Wenn man das gesamte
Aussentemperatur-Band von +20 bis -20 Grad (wenn möglich) mal mit
den zugehörigen Vorlauftemperatur (<SPAN STYLE="font-weight: normal">VL-Temp.</SPAN>)
protokolliert hat, dann kann die optimale Einstellung fixiert werden.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><B>Tip:</B><SPAN STYLE="font-weight: normal">Im
Prinzip reicht es aber aus, wenn man eine VL-Temp. bei Aussentemp.
von ca. +15 Grad und eine weitere VL-Temp. bei einer der niedrigsten
Aussentemperaturen bestimmt. Damit kann man dann mit dem Programm
(Menupunkt Extras-&gt;Heizkurve) die passenden Heizkurven Parameter
bestimmen.</SPAN></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><B>Achtung:</B> <SPAN STYLE="font-weight: normal">Bei
niedrigen Aussentemperaturen ist die aktuelle Vorlauf-Temperatur (VL
Ist) ungefähr eine Stunde nach der Umschaltung vom Absenk- zum
Tag-Betrieb zu prüfen. Die „VL Ist“ sollte sich in der Nähe der
Soll Vorlauf-Temp. befinden. Falls das nicht der Fall ist und auch
der Mischer nicht mehr mit „Mischer auf“ Kommandos angesteuert
wird (Mischer ist am Anschlag ! ), dann ist im Installateur-Bereich
für den Heizkreis der Offset-Parameter zu vergrössern.</SPAN></P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Für einen
optimalen Verbrauch sind gegebenfalls weitere Parameter im
Installateur-Bereich anzupassen.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">z.B.
Gebläsedrehzahl Stufe 2 bei einer Gasheizung oder auch die
Anforderungstemperaturen für Warmwasser.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Der Verfasser hat
einen SolvisMax Gas Pur (5 – 20kW) ohne Solar, ein Heizkreis.<BR>Es
wurden im Installateur-Bereich folgende Parameter angepasst:</P>
<UL STYLE="margin-left: 0.64cm">
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Heizkreis
	Offset: 5 Grad</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Heizung
	Gebläsedrehzahl Max: 18kW</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Wassernachheizung:
	60%</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Wasser Anf.
	Start: 7</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Wasser Anf.
	Stop: 10</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Warmwasservorrang:
	Aus</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Für die
Sommermonate hat es sich bewährt, die Heizung in den „Standby
Betrieb“ zu schalten. Für die Wintermonate wurde der „Zeit /
Automatik Betrieb“ gewählt.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><B>Hinweis:</B> <SPAN STYLE="font-weight: normal">Wenn
die Heizung im „Standby Betrieb“ während der Sommermonate
arbeitet, werden nur die Heizkreise inklusive der Heizungspumpe
abgeschaltet. Die Warmwasser Erzeugung arbeitet normal weiter. Somit
kann man in dieser Zeitphase alle Heizkörperventile voll aufdrehen,
damit sich die Federn in den Heizkörper-Ventilen entspannen können.</SPAN></P>
<H2 CLASS="western"><A NAME="LogFiles"></A>Logdateien anzeigen</H2>
<P>Im Hauptfenster des Programms SolvisSC2Viewer können die
Logdateien, die auf der Speicherkarte der „Solvis Control 2“
abgelegt sind, sichtbar gemacht werden und auch ausgedruckt werden.</P>
<P>Nach der Auswahl einer Solvis-Datei über das Datei-Menu (bzw.
Öffnen-Icon in der Toolbar) wird durch Aktivieren von einem oder
mehreren Auswahl-Elementen auf der linken Seite des Hauptfensters der
Kurvenverlauf dieser Elemente (Sensoren, Aktoren oder Optionen) in
dem Chart auf der rechten Seite dargestellt. Die Y-Achse zeigt für
die Sensoren im Regelfall die Temperatur an, während die X-Achse
generell die Zeitachse ist. Bei den Aktoren ist die Y-Achse im
Regelfall ein Prozentwert.</P>
<P>Durch Auswählen eines Zeitbereichs mit der Maus im Chart wird der
Bereich feiner aufgelöst dargestellt (Ziehen mit gedrückter linker
Maustaste im Chart). Der auswählbare Zeitbereich liegt immer
innerhalb von ganzen Stunden. Mit dem unten sichtbaren Scrollbalken
kann man durch den gesamten Zeitbereich scrollen. Zur Rückschaltung
in den weniger aufgelösten Chart ist der Knopf auf der linken Seite
des Scrollbalken mit der linken Maustaste zu drücken.<BR>Alternativ
zu der eben beschriebenen Zoom Funktion kann im Chart auch ein
Fadenkreuz gesetzt werden. Zur Umschaltung dient der ganz rechts
liegende Toolbar Schalter „Umschaltung Fadenkreuz, Zoom-Funktion“.
Mit Hilfe der Fadenkreuz Funktion kann durch Drücken der linken
Maustaste im Raster von einer Minute ein Strich im Chart eingeblendet
werden. In der unteren vertikalen Y-Achse wird ein Strich im Raster
von einer Einheit und in der oberen Y-Achse wird ein Strich im Raster
von 10 Einheiten dargestellt.<BR>Der ausgewählte Zeitbereich der
Solvis-Datei wird in den oben angeordneten Kalender-Elementen
dargestellt. Über die Kalender-Elemente kann der Zeitbereich
verändert werden. Mit den rechts von den Kalender-Elementen
liegenden Buttons kann einfach durch die Kalenderzeiten navigiert
werden, wenn der Zeitbereich vorher verkleinert wurde.</P>
<P>Im Normalfall wird der Kurvenverlauf im Chart für alle Tage beim
Öffnen der Datei angezeigt. Alternativ kann auch ein „1 Tages
Modus“ vor Öffnen der Datei angewählt werden. Dann wird nur ein
Tag angezeigt nach dem Öffnen einer Datei. Mit den im Abschnitt
vorher beschriebenen Buttons kann der zu betrachtende Tag einfach
angewählt werden.</P>
<P>Beim Datei-Öffnen können auch mehrere Dateien gleichzeitig
ausgewählt werden. Dann erscheinen in der Toolbar zwei zusätzliche
Schalter, mit denen man innerhalb der ausgewählten Dateien einfach
navigieren kann. Der Name der angezeigten Datei wird oben im
Hauptfenster angezeigt.</P>
<P><IMG SRC="description_html_m243d54ae.png" NAME="Grafik2" ALIGN=LEFT WIDTH=588 HEIGHT=83 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Die Aktoren werden generell im oberen Teil des Chart dargestellt,
die Sensoren und Optionen werden im unteren Teil dargestellt.</P>
<P>Für die Optionen gibt es im Regelfall Parameter in der
User.config Datei. Diese Parameter sind bei Bedarf im
Konfigurationsmenu anzupassen.<BR><BR><BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=128*>
	<COL WIDTH=128*>
	<THEAD>
		<TR VALIGN=TOP>
			<TH WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				Optionsname</P>
			</TH>
			<TH WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border: 1px solid #000000; padding: 0.1cm">Parameter</P>
			</TH>
		</TR>
	</THEAD>
	<TBODY>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P01, Brenner kW</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				BurnerMinPower, BurnerMaxPower</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P02, Solar kW</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				Formeleditor</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P03, Sonnenstand</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				Latitude, Longitude</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P04, VL (Ist - Soll)_1</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				TemperatureVL, NiveauVL, GradientVL</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P05, VL (Ist - Soll)_2</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				-</P>
			</TD>
		</TR>
	</TBODY>
</TABLE>
<P><BR><BR>
</P>
<P>Bei den Optionen P04 und P05 wird eine Vorlauf-Temperatur
Differenz für den Heizkreis 1 berechnet und angezeigt (Sensor S12 –
berechneter Vorlauf-Sollwert). Wichtig für eine korrekte Anzeige
sind die Einstellungen der zugehörigen Parameter. Die Werte müssen
denen in der Heizungs-Anlage entsprechen. Die in P04 eingestellten
Parameter werden auch für die Option P05 verwendet.<BR>In der Option
P04 wird der Vorlauf-Sollwert gemäß der stetig verlaufenden
Solvis-Formel berechnet.<BR>In der Option P05 wird der
Vorlauf-Sollwert nach der treppenförmig verlaufenden Formel
berechnet. Bei P05 findet eine Mittelwertbildung über 30 Minuten für
die Aussentemperatur statt. Bei Abweichungen der Differenz von
kleiner als minus 5 Grad wird die Darstellung auf minus 5 Grad
begrenzt.</P>
<H4 CLASS="western"><BR><BR>
</H4>
<H2 CLASS="western"><A NAME="LogFormat"></A>Solvis Logdaten Format</H2>
<P>Solvis speichert jede Minute einen Datensatz von Sensoren und
Aktoren mit Zeitstempel in einer Datei als Textzeile ab.<BR>Im
SolvisSC2Viewer wird beim Öffnen der Datei jeder Datensatz
interpretiert und in seine Bestandteile zerlegt. Für jeden Datensatz
wird im Programm eine Instanz der Klasse RowValues erzeugt.<BR>Der
Zeitstempel wird unter dem Namen DateAndTime im Datenformat DateTime
abgespeichert.<BR>Die Sensoren werden unter dem Namen S01 bis S24 im
Datenformat double (Gleitkomma Format) abgespeichert. Die Werte für
die Sensoren S01 bis S16 und S18 werden jeweils durch 10 dividiert.
Die Sensoren S19 bis S24 werden ohne Umrechnung abgespeichert. Der
Sensor S17 ist ein Sonderfall. Für die Chart-Darstellung wird eine
empirisch gewonnene Formel verwendet. Der dargestellte Wert hat die
Einheit Liter pro Minute. Abgespeichert ist der Sensor S17 allerdings
ohne Umrechnung des Datensatz-Wertes der Logdatei.<BR>Der Mittelwert
des Sensors S10 steht unter dem Namen S10MeanValue.<BR>Die Aktoren
werden unter dem Namen A01 bis A20 im Datenformat double
abgespeichert. Bei den Aktoren findet keine Umrechnung statt.</P>
<P>Die Bedeutung einiger Sensoren, Aktoren sind dem Verfasser nicht
bekannt.</P>
<H2 CLASS="western"><A NAME="Formulas"></A>Freie Formeln für
Chartanzeige</H2>
<P>Bei der Logdaten Anzeige stehen unter den Optionen P06, P07, P08,
P09 und P10 fünf freie Formelinterpreter für die Chartanzeige zur
Verfügung. Die Formeln sind vom Benutzer zu programmieren in der
Programmiersprache C#. Kenntnisse in einer der Programmiersprachen
C#, C, C++, Java, ... sind von Vorteil, aber keine
Grundvoraussetzung. Mit einfachen bis komplexeren Beispielen wird die
Programmierung erläutert.<BR>Falls die Formel fehlerhaft geschrieben
wurde, erscheint beim Starten des SolvisSC2Viewer eine Meldungsbox,
in der die Programm-Fehler dargestellt werden.</P>
<H4 CLASS="western">Prinzip des Aufrufs der freien Formeln:</H4>
<P>Bei angewähltem Schalter für die Option wird für jeden
Zeitpunkt des ausgewählten Zeitintervalls die Funktion der Formel
durchlaufen. Bei jeder Änderung des Zeitintervalls, also auch beim
Öffnen einer neuen Datei, wiederholt sich der Vorgang. Man spricht
bei den Aufrufen im ausgewählten Zeitintervall auch von einer
Serie.<BR>An die Funktion werden durch den SolvisSC2Viewer zwei
Parameter übergeben, bevor der von der Funktion zurückgegebene Wert
im Chart gezeichnet wird. Der erste Parameter ist die Klasse
RowValues mit dem Bezeichner rowValues. Der zweite Parameter ist ein
Aufzählungstyp (enum) SeriesState mit dem Bezeichner state. Die
Formel muß einen Rückgabeparameter vom Typ double enthalten. Dies
wird erreicht durch eine zum Schluß programmierte Anweisung „return
xx;“, wobei hier xx eine Variable vom Typ double darstellt.<BR>Über
den Bezeichner rowValues kann lesend auf die Elemente der Klasse
zugegriffen werden. Die Elemente der Klasse sind unter der
Überschrift „Solvis Logdaten Format“ genannt. Eine beispielhafte
Programmieranweisung auf ein Element lautet: return rowValues.S17;.
In diesem Fall wird der Wert von S17 für jeden Zeitpunkt im Chart
gezeichnet.<BR>Im Bezeichner state ist eine Information enthalten, ob
es sich um den ersten, letzten oder einem beliebigen anderen Aufruf
einer Serie handelt.<BR>Die möglichen Werte des enum
lauten:<BR>SeriesState.First<BR>SeriesState.Last<BR>SeriesState.Inner</P>
<H4 CLASS="western">Für erfahrene Programmierer:</H4>
<P>Die freien Formeln sind in eine zur Laufzeit des SolvisSC2Viewer
erzeugte Klasse als Funktionen eingebettet. Die Klasse wird nur
einmal instanziert. In der Klasse stehen auch ein paar freie
Variablen mit unterschiedlichen Datentypen zur Nutzung in den freien
Formeln zur Verfügung. Nachfolgend ist die Programmierung der Klasse
aufgeführt in der C#-Syntax. Die Funktionen Formula1, Formula2,
Formula3, Formula4 und Formula5 werden mit dem Programmcode des
Anwenders gefüllt.</P>
<P>Anwender, die komplexe Funktionen in den Formeln programmieren
möchten und mit dem Visual Studio arbeiten wollen, können sich bei
Bedarf an den Autor wenden.</P>
<P STYLE="margin-bottom: 0cm">namespace SolvisSC2Viewer {</P>
<P STYLE="margin-bottom: 0cm">using System;</P>
<P STYLE="margin-bottom: 0cm">using System.Windows.Forms;</P>
<P STYLE="margin-bottom: 0cm">public class Calculator : ICalculator {</P>
<P STYLE="margin-bottom: 0cm">private bool hasFormulaSolarVSG;</P>
<P STYLE="margin-bottom: 0cm">private bool hasFormulaSolarKW;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal1;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal2;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal3;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal4;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal5;</P>
<P STYLE="margin-bottom: 0cm">private double dVal1;</P>
<P STYLE="margin-bottom: 0cm">private double dVal2;</P>
<P STYLE="margin-bottom: 0cm">private double dVal3;</P>
<P STYLE="margin-bottom: 0cm">private double dVal4;</P>
<P STYLE="margin-bottom: 0cm">private double dVal5;</P>
<P STYLE="margin-bottom: 0cm">private double dVal6;</P>
<P STYLE="margin-bottom: 0cm">private double dVal7;</P>
<P STYLE="margin-bottom: 0cm">private double dVal8;</P>
<P STYLE="margin-bottom: 0cm">private double dVal9;</P>
<P STYLE="margin-bottom: 0cm">private double dVal10;</P>
<P STYLE="margin-bottom: 0cm">private int iVal1;</P>
<P STYLE="margin-bottom: 0cm">private int iVal2;</P>
<P STYLE="margin-bottom: 0cm">private int iVal3;</P>
<P STYLE="margin-bottom: 0cm">private int iVal4;</P>
<P STYLE="margin-bottom: 0cm">private int iVal5;</P>
<P STYLE="margin-bottom: 0cm">/// Default Constructor for class</P>
<P STYLE="margin-bottom: 0cm">public Calculator() {</P>
<P STYLE="margin-bottom: 0cm">hasFormulaSolarVSG = false;</P>
<P STYLE="margin-bottom: 0cm">hasFormulaSolarKW = false;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">public virtual bool HasFormulaSolarVSG
{</P>
<P STYLE="margin-bottom: 0cm">get {</P>
<P STYLE="margin-bottom: 0cm">return this.hasFormulaSolarVSG;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">public virtual bool HasFormulaSolarKW {</P>
<P STYLE="margin-bottom: 0cm">get {</P>
<P STYLE="margin-bottom: 0cm">return this.hasFormulaSolarKW;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula1</P>
<P STYLE="margin-bottom: 0cm">public double Formula1(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula2</P>
<P STYLE="margin-bottom: 0cm">public double Formula2(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula3</P>
<P STYLE="margin-bottom: 0cm">public double Formula3(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula4</P>
<P STYLE="margin-bottom: 0cm">public double Formula4(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula5</P>
<P STYLE="margin-bottom: 0cm">public double Formula5(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an FormulaSolarVSG</P>
<P STYLE="margin-bottom: 0cm">public double FormulaSolarVSG(RowValues
rowValues) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an FormulaSolarKW</P>
<P STYLE="margin-bottom: 0cm">public double FormulaSolarKW(RowValues
rowValues) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}<BR>}</P>
<P STYLE="margin-bottom: 0cm">}</P>
<H4 CLASS="western">Programmier Beispiele:</H4>
<OL STYLE="margin-left: 0.74cm">
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	rowValues.S17;</FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	rowValues.S04 - rowValues.S12;</FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	(rowValues.S17 == 0) ? 0.0 : (1.0 / ( rowValues.S17 - 7.6365)) *
	80148.4 + 4.53375;</FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#000000">if
	(state == SeriesState.First) { iVal1 = 0; dVal1 = 0.0; } iVal1++;
	dVal1 += rowValues.S10; if (state == SeriesState.Last) {
	MessageBox.Show((dVal1 / iVal1).ToString()); } </FONT><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	0.0;</FONT></FONT></FONT></P>
</OL>
<P>Information zu den Beispielen:<BR>Im Beispiel 1 wird der Sensor
S17 im Chart gezeichnet.</P>
<P>Im Beispiel 2 wird die Differenz von „Heizungspuffer oben“ und
„Vorlauf Heizkreis 1“ dargestellt.</P>
<P>Im Beispiel 3 wird eine komplexe Formel für den
Solar-Volumenstrom gezeichnet. Zuerst wird der S17 auf 0 geprüft.
Bei Gleichheit wird der Wert zwischen ? und : als return-Wert
zurückgegeben, also 0.0. Ansonsten wird die dahinterstehende Formel
als return-Wert zurückgegeben.<BR>Alternativ kann die Formel auch
folgendermassen geschrieben werden:<BR><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">if
</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">(rowValues.S17
== 0) </FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">return</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">0.0;
else </FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">return</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">(1.0
/ ( rowValues.S17 - 7.6365)) * 80148.4 + 4.53375;</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT>
</P>
<P>Beispiel 4 wendet sich an erfahrene Programmierer.<BR>Hier werden
die freien Variablen verwendet. Wie das Beispiel zeigt, sollten am
Beginn einer Serie die verwendeten Variablen initialisiert werden.
Der Sensor S10 wird zum Schluss als Mittelwert des gesamten
Zeitintervalls in einer Messagebox angezeigt.<BR>Es ist weiterhin
möglich Funktionen von Klassen zu verwenden, die in System definiert
sind (z.B. Klasse Math mit den Funktionen Abs, Round, Floor, Ceiling,
usw.).</P>
<P>Weiterführene Dokumentation zu C# z.B. unter:</P>
<P><A HREF="http://msdn.microsoft.com/de-de/library/system.math.aspx">http://msdn.microsoft.com/de-de/library/system.math.aspx</A></P>
<P><A HREF="http://openbook.galileocomputing.de/visual_csharp_2010/">http://openbook.galileocomputing.de/visual_csharp_2010/</A></P>
<H4 CLASS="western">Konfiguration „Freie Formeln“</H4>
<P>Über Extras-&gt;Konfiguration kann in den Optionen (P06 bis P10)
über Parameter und der „Ändern“ Schaltfläche ein einfacher
Formel Editor aufgerufen werden. In diesem Editor kann die „Freie
Formel“ eingegeben werden.<BR><B>Hinweis:</B> Nach einer Neueingabe
einer Formel ist das Programm neu zu starten.<BR>Programmierfehler in
den freien Formeln werden in einer „Messagebox“ beim
Programmstart angezeigt. Bei Laufzeitfehlern erscheint unten in der
Statusleiste des Programms ein Hinweistext. Es wird dann nur eine
Linie mit 0-Werten gezeichnet. In der Datei StackTrace.txt (im
Verzeichnis der User.config Datei) findet man Fehlerhinweise.</P>
<P><IMG SRC="description_html_9db6fc4.png" NAME="Grafik1" ALIGN=LEFT WIDTH=400 HEIGHT=439 BORDER=0><BR><BR>
</P>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<H2 CLASS="western"><A NAME="FormulaSolar"></A>Formeln für
Solar-Volumenstrom und Solar KW</H2>
<P>Die standardmässigen Formeln für die Chart-Darstellung lauten
(Programmiersprache C#):</P>
<P>Solar VSG (S17): <FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">return
(1.0 / (rowValues.S17 - 7.6365)) * 80148.4 + 4.53375;</FONT></FONT></FONT></P>
<P>Solar KW (P02): <FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">return
(rowValues.S05 - rowValues.S06) / (rowValues.S17 / 100.0) * 15.0;</FONT></FONT></FONT></P>
<P STYLE="color: #000000"><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Falls
der Wert von S17 den Wert Null aufweist ist das Ergebnis auch Null.</FONT></FONT></FONT></P>
<P>Diese Formeln sind empirisch ermittelt und können in der Realität
abweichend sein.</P>
<P>Aus diesem Grund bietet das Programm die Möglichkeit eigene
Berechnungen für Solar VSG (S17) und Solar KW (P02) für die Anzeige
im Chart zu definieren.<BR>Mit dem Konfigurations-Editor können beim
Sensor S17 und bei der Option P02 über den Parameter- Schalter ein
Formeleditor aufgerufen werden. In dem Formeleditor kann dann die
selbstdefinierte Formel eingegeben werden in der Programmiersprache
C# (siehe auch Kapitel „Freie Formeln“).</P>
<P>Vielleicht findet jemand korrekte universelle Formeln und teilt
diese dem Forum mit.</P>
<P><B>Hinweis:</B> Nach Änderung einer Formel ist das Programm neu
zu starten.</P>
<P>An die Funktion (Formel) wird durch den SolvisSC2Viewer ein
Parameter übergeben, bevor der von der Funktion zurückgegebene Wert
im Chart gezeichnet wird. Der Parameter ist die Klasse RowValues mit
dem Bezeichner rowValues. Die Formel muß einen Rückgabeparameter
vom Typ double enthalten. Dies wird erreicht durch eine zum Schluß
programmierte Anweisung „return xx;“, wobei hier xx eine Variable
vom Typ double darstellt.<BR>Über den Bezeichner rowValues kann
lesend auf die Elemente der Klasse zugegriffen werden. Die Elemente
der Klasse sind unter der Überschrift „Solvis Logdaten Format“
genannt. Beispielhafte Programmieranweisungen sind bei den
standardmässigen Formeln in diesem Kapitel genannt.</P>
<H2 CLASS="western"><A NAME="SensorsCheck"></A>Sensoren prüfen</H2>
<P>Im Hauptfenster kann unter dem Menupunkt „Extras“ bei
geladener Solvis-Datei der Menupunkt „Sensoren prüfen“ betätigt
werden. Hierbei wird überprüft, ob die Temperaturfühler S01
(Speicher oben) und S04 (Heizungspuffer oben) korrekt angeschlossen
sind. Falls ein Meldungsfenster erscheint mit dem Meldungstext
„Temperatur Sensoren S01 und S04 vertauscht“, dann ist der
Heizungsbetrieb zu rufen. Dieser muss die Anlage in Ordnung bringen.</P>
<H2 CLASS="western"><A NAME="SDCard"></A>SD-Card Infos</H2>
<P>Unter dem Menupunkt „Extras“ gibt es den Eintrag „SD-Card
Infos“. In dem Untermenu ist die Anzeige für den Zeitplan
auswählbar. Der Zeitplan beinhaltet tabellarisch die
Zeiteinstellungen der Heizkreise, Zirkulation, Warmwasser und Eco.
Die Information für die Zeiteinstellungen wird aus der Datei
„zeitplan.txt“ entnommen. Optional können für den Zeitplan die
Heizkreise 2 und 3 und Eco Zeiten ausgeblendet werden. Zusätzlich
kann auch das Zeitplan-Fenster als Bild-Datei namens
„TimeOverview.png“ im Dokumentenverzeichnis
(User\Dokumente\Solvis\SolvisViewer) gespeichert werden. Die
Einstellungen dafür werden im Konfigurations-Editor
durchgeführt.<BR>Die Datei „TimeOverview.png“ kann bei Bedarf
mit einem Standardprogramm für die Bildbetrachtung gedruckt werden.</P>
<P><B>Zum Testen der Anzeige für Zählerstände und Parameter</B>
kann im Konfigurations-Editor unter SD-Card die CheckBox „Anzeige
Parameter, Zählstand“ angewählt werden. Die Dateien paramact.txt
und zaehlst.txt müssen im ausgewähltem Verzeichnis liegen. Die
Parameter und Zählerstände können auch gedruckt werden. Bei den
Parametern werden die Parameter für Heizkreis 1, Wasser und
Zirkulation angezeigt.</P>
<P>Wenn korrekte Informationen zu den Dateien zaehlst.txt und
paramact.txt zur Verfügung stehen, dann wären auch Anzeigen über
Zählerstand und Parameter im SolvisSC2Viewer möglich.<BR>Datei
zaehlst.txt: Es fehlen die Bedeutungen der Werte 4 bis 6.<BR>Datei
paramact.txt: Es fehlen noch viele Parameter Bedeutungen (siehe
Sourcecode Enums.cs, HeatingSettings.cs, CirculationSettings.cs und
WaterSettings.cs im Verzeichnis app\system\solvis.</P>
<H2 CLASS="western"><BR><BR>
</H2>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
</BODY>
</HTML>