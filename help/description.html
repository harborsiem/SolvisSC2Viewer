<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 4.1.4.2 (Windows)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGED" CONTENT="20140216;184810751000000">
	<STYLE TYPE="text/css">
	<!--
		H2.cjk { font-family: "SimSun" }
		H2.ctl { font-family: "Mangal" }
		H3.western { font-family: "Albany", sans-serif }
		H3.cjk { font-family: "HG Mincho Light J" }
		H3.ctl { font-family: "Arial Unicode MS" }
		H4.western { font-family: "Albany", sans-serif; font-size: 11pt; font-style: italic }
		H4.cjk { font-family: "HG Mincho Light J"; font-size: 11pt; font-style: italic }
		H4.ctl { font-family: "Arial Unicode MS"; font-size: 11pt; font-style: italic }
	-->
	</STYLE>
</HEAD>
<BODY LANG="de-DE" DIR="LTR">
<H1>Solvis SC2 Viewer</H1>
<H2 CLASS="western"><A NAME="Installation"></A>Installation</H2>
<P>Voraussetzung f&uuml;r die Installation des Programms auf einem
Windows-System ist das .NET Framework 4.0. Falls es noch nicht auf
dem Rechner installiert ist, kann das .NET Framework 4.0 von der
Microsoft-Seite kostenfrei heruntergeladen
werden.<BR><A HREF="http://www.microsoft.com/netframework/">http://www.microsoft.com/netframework/</A><BR>Das
.NET Framework ist zuerst zu installieren. Danach erfolgt die
Installation des Programms mit der Datei SolvisSC2.msi (Doppelklick
im Explorer). Das Programm ist jetzt im Programmverzeichnis
%ProgramFiles%\Solvis\SolvisSC2 installiert. &Uuml;ber das Startmenu
Programme\SolvisSC2 kann das Programm aufgerufen werden.</P>
<H2 CLASS="western"><A NAME="Configuration"></A>Konfiguration</H2>
<P>&Uuml;ber den Menupunkt &bdquo;Extras-&gt;Konfiguration&ldquo;
kann das Programm f&uuml;r den Benutzer eingestellt werden. F&uuml;r
die Logdaten-Anzeige k&ouml;nnen die Texte, Tooltip, Farbe und
Sichtbarkeit der Sensoren, Aktoren und Optionen angepasst werden.
Hierzu w&auml;hlt man zuerst den passenden Tabulator an (Sensoren,
Aktoren, Optionen). Auf der linken Seite muss dann der zu &auml;ndernde
Sensor, Aktor oder Option angew&auml;hlt werden. Dann k&ouml;nnen f&uuml;r
dieses angew&auml;hlte Element die Werte ver&auml;ndert werden.
Allerdings ist es bei den Optionen nicht empfehlenswert die Texte zu
ver&auml;ndern, da bei den Optionen eine im Programm festgelegte
Funktion dahintersteht (Ausnahme: Freie Formeln). Bei einigen
Optionen k&ouml;nnen die relevanten Parameter eingestellt werden.
Diese Parameter werden in dem zus&auml;tzlichen Dialogfenster nach
dem Bet&auml;tigen von &bdquo;OK&ldquo; direkt &uuml;bernommen</P>
<P>Beispiel f&uuml;r Sensor S04:</P>
<P><IMG SRC="description_html_m5af52375.png" NAME="Grafik5" ALIGN=LEFT WIDTH=399 HEIGHT=366 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Beispiel f&uuml;r Option P04:</P>
<P><IMG SRC="description_html_17ed8846.png" NAME="Grafik4" ALIGN=LEFT WIDTH=397 HEIGHT=387 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Unter dem Tabulator &bdquo;Heizkurve&ldquo; k&ouml;nnen die
Grundwerte f&uuml;r das Fenster eingestellt werden, welches &uuml;ber
Extras-&gt;Heizkurve aufgerufen wird.</P>
<P><IMG SRC="description_html_194401b9.png" NAME="Grafik6" ALIGN=LEFT WIDTH=398 HEIGHT=369 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Unter dem Tabulator &bdquo;SD-Card&ldquo; k&ouml;nnen die
Grundwerte f&uuml;r das Zeitplan Fenster eingestellt werden, welches
&uuml;ber Extras-&gt;SD-Card Infos-&gt;Zeitplan aufgerufen wird. Das
Dateiverzeichnis muss auf ein Verzeichnis gesetzt werden, in dem sich
die Dateien zeitplan.txt, zaehlst.txt und paramact.txt befinden.</P>
<P><IMG SRC="description_html_63c54339.png" NAME="Grafik7" ALIGN=LEFT WIDTH=394 HEIGHT=369 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Unter dem Tabulator &bdquo;Sonstiges&ldquo; kann die SolvisControl
Version der Regler-Baugruppe eingestellt werden (erster Zahlenwert in
der Versionsbezeichnung). Bei Werten kleiner als 132 ist der Dateityp
f&uuml;r Logdateien &bdquo;so*.txt&ldquo; vorausgew&auml;hlt. Bei
Werten ab 132 ist der Dateityp f&uuml;r Logdateien &bdquo;mi*.txt&ldquo;
vorausgew&auml;hlt. Unabh&auml;ngig von der eingestellten Version
k&ouml;nnen sowohl &bdquo;so*.txt&ldquo; als auch &bdquo;mi*.txt&ldquo;
ausgew&auml;hlt werden.</P>
<P><IMG SRC="description_html_mc66b36a.png" NAME="Grafik3" ALIGN=LEFT WIDTH=394 HEIGHT=366 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Mit dem &bdquo;Defaults&ldquo;-Schalter werden die im Programm
festgelegten Grundwerte aktiviert.<BR><BR>Die meisten &Auml;nderungen
der Konfiguration sind sofort wirksam nach Bet&auml;tigen des
OK-Schalter.<BR><BR>Nach dem Beenden des Programms wird eine
Konfigurationsdatei (User.config) angelegt. Der Pfad f&uuml;r die
User.config ist unterschiedlich bei verschiedenen Betriebssystemen.
<BR>Unter Windows XP lautet der Pfad &bdquo;Dokumente und
Einstellungen\&lt;<I>UserName</I>&gt;\Anwendungsdaten\Solvis\SolvisViewer&ldquo;.
<BR>Unter Windows Vista, Windows 7, ... lautet der Pfad
&bdquo;User\&lt;<I>UserName</I>&gt;\AppData\Roaming\Solvis\SolvisViewer&ldquo;.<BR><BR>Die
User.config ist eine Xml-Datei. Alternativ kann auch diese Datei mit
einem Xml-Editor oder einem normalen (UTF8 f&auml;higen) Texteditor
bearbeitet werden.&Uuml;ber die Xml-Datei k&ouml;nnen Text, ToolTip,
Aktivierzustand (Checked), Sichtbarkeit (Visible), Farbe (ColorRGB)
der Sensoren S01 bis S24, der Aktoren A01 bis A20 und den Optionen
P01 bis P08 angepasst werden.<BR>Checked und Visible k&ouml;nnen auf
die Werte &bdquo;true&ldquo; oder &bdquo;false&ldquo; gesetzt werden.
Bei ColorRGB wird ein RGB-Wert (Rot, Gr&uuml;n, Blau-Anteil)
eingestellt. Jeder der drei durch Komma getrennten Werte kann im
Bereich 0 bis 255 liegen. Der Wert 0,0,0 entspricht Schwarz,
255,255,255 entspricht Wei&szlig;.</P>
<P>Im Xml-Tag &bdquo;OpenDir&ldquo; ist der Pfad f&uuml;r das &Ouml;ffnen
der Solvis-Logdatei hinterlegt.<BR>Im Xml-Tag &bdquo;Version&ldquo;
ist die aktuelle Programmversion hinterlegt.<BR>In BurnerMinPower
(Brenner minimale Leistung) und BurnerMaxPower (Brenner maximale
Leistung) k&ouml;nnen die Werte f&uuml;r den Brenner eingestellt
werden.</P>
<P>In Latitude und Longitude k&ouml;nnen die eigenen geografischen
Koordinaten eingestellt werden f&uuml;r die Darstellung des
Sonnenstands.</P>
<P>In Temperature, Niveau und Gradient werden die Startwerte f&uuml;r
die Heizkurve eingestellt.<BR>Temperature darf nur ganzzahlig im
Bereich 12 bis 28,<BR>Niveau darf nur ganzzahlig im Bereich -5 bis
+5,<BR>Gradient darf nur in 0.05 Schritten im Bereich 0.50 bis
2.00<BR>vorgegeben werden.</P>
<P>In TemperatureVL, NiveauVL und GradientVL werden die Werte der
Heizungs-Anlage eingestellt. Diese Werte dienen der Bestimmung der
Abweichung von der Vorlauftemperatur des ersten Heizkreises.</P>
<P><B>Achtung: </B><SPAN STYLE="font-weight: normal">Die Werte mit
Nachkommastellen m&uuml;ssen in der User.config Datei mit einem Punkt
eingegeben werden (z.B. 7.5).<BR>Bei Falscheingabe wird eine Datei
StackTrace.txt im oben genannten Verzeichnis erzeugt.</SPAN></P>
<P>Beim jedem neuen Programmstart werden die aktuellen Werte aus der
User.config Datei verwendet.</P>
<P><B>Xml-Editor:</B> z.B. Xml Notepad 2007 von Microsoft</P>
<P><A HREF="http://www.microsoft.com/download/en/details.aspx?id=7973">http://www.microsoft.com/download/en/details.aspx?id=7973</A></P>
<P><BR><BR>
</P>
<H2 CLASS="western"><A NAME="HeatCurve"></A>Heizkurve</H2>
<P>Durch Anw&auml;hlen des Menupunkts Extras/Heizkurve wird ein neues
Fenster ge&ouml;ffnet f&uuml;r die Darstellung von drei
parametrierbaren Heizkurven. Hierbei zeigen die ersten beiden Kurven
(Curve1 und Curve2) den echten von Solvis realisierten Verlauf der
Heizkurve. Der Verlauf ist gepr&auml;gt durch eine Rundung auf ganze
Grad f&uuml;r die Vorlauf-Temperatur. Man sieht aber auch deutlich
den Versatz bei negativen Au&szlig;entemperaturen. Die dritte Kurve
zeigt einen idealisierten Verlauf der Kurve (Ideal), wie sie in der
Solvis Beschreibung L30 dargestellt ist. F&uuml;r alle Kurven kann
die Raum-Solltemperatur (Temperature) (Display <I><U>Heizkreis-Menu,
Seite 3</U></I>), Steilheit (Gradient) (<I><U>Heizkreis-Menu, Seite
2</U></I>) und Niveau (Thermometersymbol im Heizungs-Menu) vorgegeben
werden.</P>
<P><B>Anmerkung des Verfassers:</B> &lt;Den Parameter &bdquo;Niveau&ldquo;
h&auml;tte ich auch im Heizkreis-Menu erwartet. Das Thermometer
Symbol w&auml;re nur zur (additiven) Feinregulierung des &bdquo;Niveaus&ldquo;
notwendig.<BR>Aber es gibt zumindest eine getrennte Einstellung des
&bdquo;Niveaus&ldquo; f&uuml;r jeden Heizkreis &uuml;ber das
Thermometer Symbol im Heizungs-Menu.&gt;</P>
<P>Durch Variation der im unteren Teil des Fensters verf&uuml;gbaren
Parameter wird der Einfluss in der Heizkurve grafisch sichtbar
gemacht. Somit kann man relativ leicht beurteilen, wie sich die
&Auml;nderungen von Parametern auswirken. &Uuml;ber den Menupunkt
&bdquo;Drucken&ldquo; kann eine Druckvorschau (PrintPreview) oder ein
Druck (Print) ausgel&ouml;st werden.</P>
<P>Mit dem Menupunkt &bdquo;Konfiguration&ldquo; k&ouml;nnen die
Berechnungsverfahren der Kurven ver&auml;ndert werden. Der obere Teil
in dem aufgeklappten Menu ist f&uuml;r die Kurve1 (Curve1), w&auml;hrend
der untere Teil f&uuml;r die Kurve2 zust&auml;ndig ist. Ohne Anwahl
einer der Menupunkte wird der Originalverlauf der <B>SolvisControl 2</B>
dargestellt.<BR>Mit dem Aktivieren von &bdquo;floor&ldquo;, &bdquo;round&ldquo;
oder &bdquo;nicht gerundet&ldquo; f&uuml;r Curve1 bzw. Curve2 wird
die bei Solvis verwendete Formel mit unterschiedlichen
Rundungsverfahren dargestellt. Der Verfasser ist der Meinung, dass
die alternativen Berechnungs-Modelle besser geeignet w&auml;ren f&uuml;r
die Bestimmung der Heizkurve und der Idealkurve am n&auml;chsten
k&auml;men, wenn man die Mischer-Steuerung mit ganzen Grad-Zahlen
durchf&uuml;hren muss. Nach eigenen Beobachtungen k&auml;men die
&bdquo;round&ldquo; oder &bdquo;nicht gerundet&ldquo; Formel der
Realit&auml;t am n&auml;chsten. Zus&auml;tzlich m&uuml;sste nach
Ansicht des Verfassers aber auch eine Betrachtung &uuml;ber VL Ist
und VL Soll &uuml;ber einen angemessenen Zeitraum in der
&bdquo;<B>SolvisControl 2</B>&ldquo; stattfinden. Die aufgetretenen
Abweichungen in dem zugrunde liegenden Zeitraum k&ouml;nnte die
&bdquo;<B>SolvisControl 2</B>&ldquo; durch zus&auml;tzlichen Eingriff
in die Mischer-Steuerung korrigieren.</P>
<P>Die zugrunde liegende Basis-Formel lautet:<BR>VL = k1 * G * (RT &ndash;
AT)**k2 + RT + N<BR>Hierbei sind<BR>VL = Vorlauftemperatur<BR>k1, k2
= Konstanten<BR>G = Gradient oder Steilheit<BR>RT = Raumtemperatur<BR>AT
= Au&szlig;entemperatur<BR>N = Niveau<BR>k1 wurde mit dem Wert 1.8207
und k2 mit 0.8 angenommen. Die tats&auml;chlichen Werte, die Solvis
verwendet hat, k&ouml;nnen geringf&uuml;gig abweichen.</P>
<H3 CLASS="western">Formeln in der Programmiersprache C dargestellt:</H3>
<P>Floor-Formel: VL = (int)(k1 * G * pow(RT &ndash; floor(AT), k2) +
RT + N);</P>
<P>Round-Formel: VL = round(k1 * G * pow(RT &ndash; round(AT * 2) /
2, k2) + RT + N);<BR>Hinweis: Die Round-Formel rundet auf halbe Grad
f&uuml;r die Au&szlig;entemperatur.</P>
<P>nicht gerundet-Formel: VL = round(k1 * G * pow(RT &ndash; AT, k2)
+ RT + N);</P>
<P>wahrscheinliche Solvis-Formel: VL = (int)(k1 * G * pow(RT &ndash;
(int)(AT), k2) + RT + N);<BR><BR>Da round keine Standardfunktion in
der C-Bibliothek ist, muss sie folgenderma&szlig;en definiert
werden:<BR>int round(double value) {<BR>if (value &gt;= 0.0)<BR>return
(int)(value + 0.5);<BR>else<BR>return (int)(value - 0.5);<BR>}</P>
<P>Im Internet findet man diverse Vorgehensweisen f&uuml;r die
Bestimmung von optimalen Heizkurven. z.B.</P>
<P><A HREF="http://www.shk-mayer.de/Page/Waermeerzeuger/Heizkurve.html">http://www.shk-mayer.de/Page/Waermeerzeuger/Heizkurve.html</A></P>
<P><A HREF="http://www.moria.de/~michael/haus/energie/heizkurve.html">http://www.moria.de/~michael/haus/energie/heizkurve.html</A></P>
<H2 CLASS="western"><A NAME="Optimize"></A>Optimale Heizkurve
(Vorlauftemp.) einstellen</H2>
<P STYLE="margin-bottom: 0cm">Die Steuerung der Vorlauftemperatur in
der SolvisControl basiert auf der Au&szlig;entemperatur und einigen
Parametern (Heizkurve), die der Nutzer der Heizungsanlage
einzustellen hat.</P>
<P STYLE="margin-bottom: 0cm">Um die optimale Heizkurve f&uuml;r den
niedrigsten Energieverbrauch einstellen zu k&ouml;nnen, ist eine
komplette Heizperiode erforderlich. Erforderlich f&uuml;r die
Bestimmung der Heizkurve sind unterschiedliche Au&szlig;entemperaturen.
Zu beachten ist auch die Empfehlung von Solvis f&uuml;r die Montage
des Au&szlig;entemperatur-F&uuml;hlers. <BR>Der F&uuml;hler muss vor
direkter Sonneneinstrahlung gesch&uuml;tzt werden. In der Praxis ist
dies allerdings schwierig umzusetzen. Ein zweiter F&uuml;hler an
anderer Position des Hauses, der zus&auml;tzlich in die Regelung
einflie&szlig;t, w&auml;re sicherlich eine sinnvolle Erg&auml;nzung
in der Heizungs-Steuerung. In der Regelung der SolvisControl muss
dann die jeweils niedrigste Au&szlig;entemperatur der beiden F&uuml;hler
verwendet werden.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Bei der <B>SolvisControl 2</B> hat man
f&uuml;r die Einstellung der Heizkurve drei Parameter zur Verf&uuml;gung.</P>
<OL>
	<LI><P STYLE="margin-bottom: 0cm">Raum-Soll-Temperatur
	(<I><U>Heizkreismenu, Seite 3</U></I>)</P>
	<LI><P STYLE="margin-bottom: 0cm">Niveau: Im Menu Heizung ist dies
	der Schaltwippen-Wert des Thermometersymbols.</P>
	<LI><P STYLE="margin-bottom: 0cm">Steilheit der Heizkurve:
	(<I><U>Heizkreismenu, Seite 2</U></I>)</P>
</OL>
<P STYLE="margin-bottom: 0cm"><BR>Bei der Einstellung der Parameter
f&uuml;r die Vorlauftemperatur sollte man folgenderma&szlig;en
vorgehen (ohne Raumf&uuml;hler):</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">Heizk&ouml;rperventile voll
	aufdrehen (Heizk&ouml;rper sollten hydraulisch abgeglichen sein).</P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm">gew&uuml;nschte Temperatur (z.B.
	21 Grad) <I><U>im Heizkreismenu, Seite 3</U></I> als
	Raum-Solltemperatur einstellen.</P>
	<LI><P STYLE="margin-bottom: 0cm">Einen Grundwert f&uuml;r die
	Steilheit einstellen (z.B. 1,2 ) <I><U>im Heizkreismenu auf Seite 2</U></I>.
	Es sollte die Empfehlung aus der Solvis-Beschreibung bzw. des
	Heizungsbetriebs ber&uuml;cksichtigt werden f&uuml;r die Festlegung
	des Grundwertes.</P>
	<LI><P STYLE="margin-bottom: 0cm">Dann den Niveau Parameter so
	einstellen, das sich eine Temperatur von ungef&auml;hr 21 Grad in
	den R&auml;umen ergibt. Ein bis zwei Tage Wartezeit sind
	erforderlich nach jeder &Auml;nderung.</P>
	<LI><P STYLE="margin-bottom: 0cm">Bei einigerma&szlig;en
	gleichm&auml;&szlig;igen Au&szlig;entemperaturen ist die zugeh&ouml;rige
	Soll Vorlauf-Temperatur tabellarisch zu notieren. Der
	Au&szlig;entemperatur Mittelwert und die Soll Vorlauf-Temperatur
	k&ouml;nnen im <I><U>Heizkreismenu auf Seite 4 und 5</U></I> f&uuml;r
	die Tabelle abgelesen werden. Unter Umst&auml;nden sind jetzt Niveau
	bzw. Steilheit in kleinen Schritten anzupassen, so dass die
	Temperatur in den R&auml;umen stimmt.</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>Wenn man das gesamte
Au&szlig;entemperatur-Band von +20 bis -20 Grad (wenn m&ouml;glich)
mal mit den zugeh&ouml;rigen Vorlauftemperaturen (<SPAN STYLE="font-weight: normal">VL-Temp.</SPAN>)
protokolliert hat, dann kann die optimale Einstellung fixiert werden.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><B>Tip:</B><SPAN STYLE="font-weight: normal">Im
Prinzip reicht es aber aus, wenn man eine VL-Temp. bei Au&szlig;entemp.
von ca. +15 Grad und eine weitere VL-Temp. bei einer der niedrigsten
Au&szlig;entemperaturen in den Wintermonaten bestimmt. Damit kann man
dann mit dem Programm (Menupunkt Extras-&gt;Heizkurve) die passenden
Heizkurven Parameter bestimmen.</SPAN></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><B>Achtung:</B> <SPAN STYLE="font-weight: normal">Bei
niedrigen Au&szlig;entemperaturen ist die aktuelle Vorlauf-Temperatur
(VL Ist) ungef&auml;hr eine Stunde nach der Umschaltung vom Absenk-
zum Tag-Betrieb zu pr&uuml;fen. Die &bdquo;VL Ist&ldquo; sollte sich
in der N&auml;he der Soll Vorlauf-Temp. befinden. Falls das nicht der
Fall ist und auch der Mischer nicht mehr mit &bdquo;Mischer auf&ldquo;
Kommandos angesteuert wird (Mischer ist am Anschlag ! ), dann ist im
Installateur-Bereich f&uuml;r den Heizkreis der Offset-Parameter zu
vergr&ouml;&szlig;ern.</SPAN></P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">F&uuml;r einen
optimalen Verbrauch sind gegebenenfalls weitere Parameter im
Installateur-Bereich anzupassen.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">z.B.
Gebl&auml;sedrehzahl Stufe 2 bei einer Gasheizung oder auch die
Anforderungstemperaturen f&uuml;r Warmwasser.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Der Verfasser hat
einen SolvisMax Gas Pur (5 &ndash; 20kW) ohne Solar, ein
Heizkreis.<BR>Es wurden im Installateur-Bereich folgende Parameter
angepasst:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Heizkreis
	Offset: 5 Kelvin</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Heizung
	Gebl&auml;sedrehzahl Max: 18kW</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Wassernachheizung:
	45% (entspricht einer Leistung von 5kW + 0,45*15kW)</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Wasser Anf.
	Start: 7</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Wasser Anf.
	Stop: 10</P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal">Warmwasservorrang:
	Aus</P>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Beim Verfasser hat
es sich f&uuml;r die <U>Sommermonate</U> bew&auml;hrt, die Heizung in
den &bdquo;Standby Betrieb&ldquo; zu schalten. F&uuml;r die
<I>Wintermonate</I> wurde der &bdquo;Zeit / Automatik Betrieb&ldquo;
gew&auml;hlt.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Im <U>Fr&uuml;hjahr
und Herbst</U> kann der Wert der Heizkreiswippe im Regelfall um ein
bis mehrere Kelvin reduziert werden, da die nicht beheizten
Umgebungsr&auml;ume (Keller, Dachboden, &hellip;) dann w&auml;rmer
sind als im Winter. Auch Sonne, Wind, ... haben hierbei einen
Einfluss auf die Raumtemperaturen.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Anhand der hier
aufgef&uuml;hrten Informationen erkennt man, das es nicht einfach
ist, die richtigen Einstellungen zu w&auml;hlen.</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal">Eine selbst
optimierende Heizungssteuerung w&auml;re sicherlich ein
Zukunftstraum.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><B>Hinweis:</B> <SPAN STYLE="font-weight: normal">Wenn
die Heizung im &bdquo;Standby Betrieb&ldquo; w&auml;hrend der
Sommermonate arbeitet, werden nur die Heizkreise inklusive der
Heizungspumpe abgeschaltet. Die Warmwasser Erzeugung arbeitet normal
weiter. Somit kann man in dieser Zeitphase alle Heizk&ouml;rperventile
voll aufdrehen, damit sich die Federn in den Heizk&ouml;rper-Ventilen
entspannen k&ouml;nnen.</SPAN></P>
<H2 CLASS="western"><A NAME="LogFiles"></A>Logdateien anzeigen</H2>
<P>Im Hauptfenster des Programms SolvisSC2Viewer k&ouml;nnen die
Logdateien, die auf der Speicherkarte der &bdquo;<B>SolvisControl 2</B>&ldquo;
abgelegt sind, sichtbar gemacht werden und auch ausgedruckt werden.</P>
<P>Bis zur SolvisControl Regler-Version Z131 gibt es die Logdateien
&bdquo;so*.txt&ldquo;. Ab der Version Z132 hei&szlig;en die
Logdateien &bdquo;mi*.txt&ldquo;. Die Vorauswahl der
unterschiedlichen Dateitypen wird durch eine
Konfigurations-Einstellung der SolvisControl Version im
SolvisSC2Viewer ber&uuml;cksichtigt. Unabh&auml;ngig von der
eingestellten Version k&ouml;nnen sowohl die Dateitypen &bdquo;mi*.txt&ldquo;
als auch &bdquo;so*.txt&ldquo; ausgew&auml;hlt werden beim Datei
&Ouml;ffnen Dialogfenster.</P>
<P>Nach der Auswahl einer oder mehrerer Solvis-Logdatei(en) &uuml;ber
das Datei-Menu (bzw. &Ouml;ffnen-Icon in der Toolbar) wird der Inhalt
grafisch angezeigt. Durch Aktivieren von einem oder mehreren
Auswahl-Elementen auf der linken Seite des Hauptfensters wird der
Kurvenverlauf dieser Elemente (Sensoren, Aktoren oder Optionen) in
dem Chart auf der rechten Seite dargestellt. Die Y-Achse zeigt f&uuml;r
die Sensoren im Regelfall die Temperatur an, w&auml;hrend die X-Achse
generell die Zeitachse ist. Bei den Aktoren ist die Y-Achse im
Regelfall ein Prozentwert.</P>
<P>Durch Ausw&auml;hlen eines Zeitbereichs mit der Maus im Chart wird
der Bereich feiner aufgel&ouml;st dargestellt (Ziehen mit gedr&uuml;ckter
linker Maustaste im Chart). Der ausw&auml;hlbare Zeitbereich liegt
immer innerhalb von ganzen Stunden. Mit dem unten sichtbaren
Scrollbalken kann man durch den gesamten Zeitbereich scrollen. Zur
R&uuml;ckschaltung in den weniger aufgel&ouml;sten Chart ist der
Knopf auf der linken Seite des Scrollbalken mit der linken Maustaste
zu dr&uuml;cken.<BR>Alternativ zu der eben beschriebenen Zoom
Funktion kann im Chart auch ein Fadenkreuz gesetzt werden. Zur
Umschaltung dient der ganz rechts liegende Toolbar Schalter
&bdquo;Umschaltung Fadenkreuz, Zoom-Funktion&ldquo;. Mit Hilfe der
Fadenkreuz Funktion kann durch Dr&uuml;cken der linken Maustaste im
Raster von einer Minute ein Strich im Chart eingeblendet werden. In
der unteren vertikalen Y-Achse wird ein Strich im Raster von einer
Einheit und in der oberen Y-Achse wird ein Strich im Raster von 10
Einheiten dargestellt.<BR>Der ausgew&auml;hlte Zeitbereich der
Solvis-Logdatei wird in den oben angeordneten Kalender-Elementen
dargestellt. &Uuml;ber die Kalender-Elemente kann der Zeitbereich
ver&auml;ndert werden. Mit den rechts von den Kalender-Elementen
liegenden Buttons kann einfach durch die Kalenderzeiten navigiert
werden, wenn der Zeitbereich vorher verkleinert wurde.</P>
<P>Im Normalfall wird der Kurvenverlauf im Chart f&uuml;r alle Tage
beim &Ouml;ffnen der Datei angezeigt. Alternativ kann auch ein &bdquo;1
Tages Modus&ldquo; vor &Ouml;ffnen der Datei angew&auml;hlt werden.
Dann wird nur ein Tag angezeigt nach dem &Ouml;ffnen einer Datei. Mit
den im Abschnitt vorher beschriebenen Buttons kann der zu
betrachtende Tag einfach angew&auml;hlt werden.</P>
<P>Beim Datei-&Ouml;ffnen k&ouml;nnen auch mehrere Dateien
gleichzeitig ausgew&auml;hlt werden. Dann erscheinen in der Toolbar
zwei zus&auml;tzliche Schalter, mit denen man innerhalb der
ausgew&auml;hlten Dateien einfach navigieren kann. Der Name der
angezeigten Datei wird oben im Hauptfenster angezeigt.</P>
<P><IMG SRC="description_html_m243d54ae.png" NAME="Grafik2" ALIGN=LEFT WIDTH=588 HEIGHT=83 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Die Aktoren werden generell im oberen Teil des Chart dargestellt,
die Sensoren und Optionen werden im unteren Teil dargestellt.</P>
<P>F&uuml;r die Optionen gibt es im Regelfall Parameter in der
User.config Datei. Diese Parameter sind bei Bedarf im
Konfigurationsmenu anzupassen.<BR><BR><BR>
</P>
<TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0>
	<COL WIDTH=128*>
	<COL WIDTH=128*>
	<THEAD>
		<TR VALIGN=TOP>
			<TH WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				Optionsname</P>
			</TH>
			<TH WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border: 1px solid #000000; padding: 0.1cm">Parameter</P>
			</TH>
		</TR>
	</THEAD>
	<TBODY>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P01, Brenner kW</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				BurnerMinPower, BurnerMaxPower</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P02, Solar kW</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				Formeleditor, VSG Pulszahl, spez. W&auml;rmekapazit&auml;t</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P03, Sonnenstand</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				Latitude, Longitude</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P04, VL (Ist - Soll)_1</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				TemperatureVL, NiveauVL, GradientVL</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				P05, VL (Ist - Soll)_2</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				Parameter werden von P04 verwendet.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				S17, Solar VSG</P>
			</TD>
			<TD WIDTH=50% STYLE="border: none; padding: 0cm">
				<P STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				Formeleditor, VSG Pulszahl, spez. W&auml;rmekapazit&auml;t</P>
			</TD>
		</TR>
	</TBODY>
</TABLE>
<P><BR><BR>
</P>
<P>Bei den Optionen P04 und P05 wird eine Vorlauf-Temperatur
Differenz f&uuml;r den Heizkreis 1 berechnet und angezeigt (Sensor
S12 &ndash; berechneter Vorlauf-Sollwert). Wichtig f&uuml;r eine
korrekte Anzeige sind die Einstellungen der zugeh&ouml;rigen
Parameter. Die Werte m&uuml;ssen denen in der Heizungs-Anlage
entsprechen. Die in P04 eingestellten Parameter werden auch f&uuml;r
die Option P05 verwendet.<BR>In der Option P04 wird der
Vorlauf-Sollwert gem&auml;&szlig; der stetig verlaufenden
Solvis-Formel berechnet.<BR>In der Option P05 wird der
Vorlauf-Sollwert nach der treppenf&ouml;rmig verlaufenden Formel
berechnet. Bei P05 findet eine Mittelwertbildung &uuml;ber 30 Minuten
f&uuml;r die Au&szlig;entemperatur statt. Bei Abweichungen der
Differenz von kleiner als minus 5 Grad wird die Darstellung auf minus
5 Grad begrenzt.</P>
<H4 CLASS="western" STYLE="font-variant: normal; font-style: normal; font-weight: normal">
<FONT FACE="Times New Roman, serif">Bei der Option P02 und dem Sensor
S17 k&ouml;nnen die VSG-Pulszahl f&uuml;r eine korrekte Berechnung
des Volumenstroms und der solaren Leistung eingestellt werden. Werte
von 2 bzw. 42 sind &uuml;blich.</FONT></H4>
<H2 CLASS="western"><A NAME="LogFormat"></A>Solvis Logdaten Format</H2>
<P>&bdquo;<B>SolvisControl 2</B>&ldquo; speichert jede Minute einen
Datensatz von Sensoren und Aktoren mit Zeitstempel in einer Datei als
Textzeile ab.</P>
<P>Abh&auml;ngig von der SolvisControl Regler-Version sind die
Inhalte der Logdateien teilweise unterschiedlich. Auch die Namen der
Logdateien sind unterschiedlich. Bis zur Version Z131 hei&szlig;en
die Dateitypen &bdquo;so*.txt&ldquo;. Ab Version Z132 hei&szlig;en
sie &bdquo;mi*.txt&ldquo;. Im unteren Teil dieses Kapitels wird der
Unterschied des Dateityps &bdquo;mi*.txt&ldquo; beschrieben. F&uuml;r
die Auswahlm&ouml;glichkeit beim Datei &Ouml;ffnen Dialog steht ein
Konfigurationsdatum im SolvisSC2Viewer zur Verf&uuml;gung.</P>
<P>Im SolvisSC2Viewer wird beim &Ouml;ffnen der Datei jeder Datensatz
interpretiert und in seine Bestandteile zerlegt. F&uuml;r jeden
Datensatz wird im Programm eine Instanz der Klasse RowValues
erzeugt.<BR>Der Zeitstempel wird unter dem Namen DateAndTime im
Datenformat DateTime abgespeichert.<BR>Die Sensoren werden unter dem
Namen S01 bis S24 im Datenformat double (Gleitkomma Format)
abgespeichert. Die Werte f&uuml;r die Sensoren S01 bis S16 und S18
werden jeweils durch 10 dividiert. Die Sensoren S19 bis S24 werden
ohne Umrechnung abgespeichert. Der Sensor S17 ist ein Sonderfall. F&uuml;r
die Chart-Darstellung wird eine empirisch gewonnene Formel verwendet.
Der dargestellte Wert hat die Einheit Liter pro Stunde. Abgespeichert
ist der Sensor S17 allerdings ohne Umrechnung des Datensatz-Wertes
der Logdatei. Sensor S18 (Warmwasser VSG) hat die Einheit Liter pro
Minute.<BR>Der Mittelwert des Sensors S10 steht unter dem Namen
S10MeanValue.<BR>Die Aktoren werden unter dem Namen A01 bis A20 im
Datenformat double abgespeichert. Bei den Aktoren findet keine
Umrechnung statt.</P>
<P>Unterschied des Dateityps &bdquo;mi*.txt&ldquo; zum Typ &bdquo;so*.txt&ldquo;:
Die Werte der Sensoren S19 bis S21 (Raumf&uuml;hler) sind mit einer
Nachkommastelle abgelegt. Der Sensor S17 (Solar VSG) gibt den Wert in
der Einheit Liter pro Stunde an [l / h].</P>
<P>Die Bedeutung einiger Sensoren, Aktoren und deren Einheiten sind
dem Verfasser nicht bekannt.</P>
<H2 CLASS="western"><A NAME="Formulas"></A>Freie Formeln f&uuml;r
Chartanzeige</H2>
<P>Bei der Logdaten Anzeige stehen unter den Optionen P06, P07, P08,
P09 und P10 f&uuml;nf freie Formelinterpreter f&uuml;r die
Chartanzeige zur Verf&uuml;gung. Die Formeln sind vom Benutzer zu
programmieren in der Programmiersprache C#. Kenntnisse in einer der
Programmiersprachen C#, C, C++, Java, ... sind von Vorteil, aber
keine Grundvoraussetzung. Mit einfachen bis komplexeren Beispielen
wird die Programmierung erl&auml;utert.<BR>Falls die Formel
fehlerhaft geschrieben wurde, erscheint beim Starten des
SolvisSC2Viewer eine Meldungsbox, in der die Programm-Fehler
dargestellt werden.</P>
<H4 CLASS="western">Prinzip des Aufrufs der freien Formeln:</H4>
<P>Bei angew&auml;hltem Schalter f&uuml;r die Option wird f&uuml;r
jeden Zeitpunkt des ausgew&auml;hlten Zeitintervalls die Funktion der
Formel durchlaufen. Bei jeder &Auml;nderung des Zeitintervalls, also
auch beim &Ouml;ffnen einer neuen Datei, wiederholt sich der Vorgang.
Man spricht bei den Aufrufen im ausgew&auml;hlten Zeitintervall auch
von einer Serie.<BR>An die Funktion werden durch den SolvisSC2Viewer
zwei Parameter &uuml;bergeben, bevor der von der Funktion
zur&uuml;ckgegebene Wert im Chart gezeichnet wird. Der erste
Parameter ist die Klasse RowValues mit dem Bezeichner rowValues. Der
zweite Parameter ist ein Aufz&auml;hlungstyp (enum) SeriesState mit
dem Bezeichner state. Die Formel muss einen R&uuml;ckgabeparameter
vom Typ double enthalten. Dies wird erreicht durch eine zum Schluss
programmierte Anweisung &bdquo;return xx;&ldquo;, wobei hier xx eine
Variable vom Typ double darstellt.<BR>&Uuml;ber den Bezeichner
rowValues kann lesend auf die Elemente der Klasse zugegriffen werden.
Die Elemente der Klasse sind unter der &Uuml;berschrift &bdquo;Solvis
Logdaten Format&ldquo; genannt. Eine beispielhafte
Programmieranweisung auf ein Element lautet: return rowValues.S17;.
In diesem Fall wird der Wert von S17 f&uuml;r jeden Zeitpunkt im
Chart gezeichnet.<BR>Im Bezeichner state ist eine Information
enthalten, ob es sich um den ersten, letzten oder einem beliebigen
anderen Aufruf einer Serie handelt.<BR>Die m&ouml;glichen Werte des
enum lauten:<BR>SeriesState.First<BR>SeriesState.Last<BR>SeriesState.Inner</P>
<H4 CLASS="western">F&uuml;r erfahrene Programmierer:</H4>
<P>Die freien Formeln sind in eine zur Laufzeit des SolvisSC2Viewer
erzeugte Klasse als Funktionen eingebettet. Die Klasse wird nur
einmal instanziiert. In der Klasse stehen auch ein paar freie
Variablen mit unterschiedlichen Datentypen zur Nutzung in den freien
Formeln zur Verf&uuml;gung. Nachfolgend ist die Programmierung der
Klasse aufgef&uuml;hrt in der C#-Syntax. Die Funktionen Formula1,
Formula2, Formula3, Formula4 und Formula5 werden mit dem Programmcode
des Anwenders gef&uuml;llt.</P>
<P>Anwender, die komplexe Funktionen in den Formeln programmieren
m&ouml;chten und mit dem Visual Studio arbeiten wollen, k&ouml;nnen
sich bei Bedarf an den Autor wenden.</P>
<P STYLE="margin-bottom: 0cm">namespace SolvisSC2Viewer {</P>
<P STYLE="margin-bottom: 0cm">using System;</P>
<P STYLE="margin-bottom: 0cm">using System.Windows.Forms;</P>
<P STYLE="margin-bottom: 0cm">public class Calculator : ICalculator {</P>
<P STYLE="margin-bottom: 0cm">private bool hasFormulaSolarVSG;</P>
<P STYLE="margin-bottom: 0cm">private bool hasFormulaSolarKW;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal1;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal2;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal3;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal4;</P>
<P STYLE="margin-bottom: 0cm">private bool bVal5;</P>
<P STYLE="margin-bottom: 0cm">private double dVal1;</P>
<P STYLE="margin-bottom: 0cm">private double dVal2;</P>
<P STYLE="margin-bottom: 0cm">private double dVal3;</P>
<P STYLE="margin-bottom: 0cm">private double dVal4;</P>
<P STYLE="margin-bottom: 0cm">private double dVal5;</P>
<P STYLE="margin-bottom: 0cm">private double dVal6;</P>
<P STYLE="margin-bottom: 0cm">private double dVal7;</P>
<P STYLE="margin-bottom: 0cm">private double dVal8;</P>
<P STYLE="margin-bottom: 0cm">private double dVal9;</P>
<P STYLE="margin-bottom: 0cm">private double dVal10;</P>
<P STYLE="margin-bottom: 0cm">private int iVal1;</P>
<P STYLE="margin-bottom: 0cm">private int iVal2;</P>
<P STYLE="margin-bottom: 0cm">private int iVal3;</P>
<P STYLE="margin-bottom: 0cm">private int iVal4;</P>
<P STYLE="margin-bottom: 0cm">private int iVal5;</P>
<P STYLE="margin-bottom: 0cm">/// Default Constructor for class</P>
<P STYLE="margin-bottom: 0cm">public Calculator() {</P>
<P STYLE="margin-bottom: 0cm">hasFormulaSolarVSG = false;</P>
<P STYLE="margin-bottom: 0cm">hasFormulaSolarKW = false;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">public virtual bool HasFormulaSolarVSG
{</P>
<P STYLE="margin-bottom: 0cm">get {</P>
<P STYLE="margin-bottom: 0cm">return this.hasFormulaSolarVSG;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">public virtual bool HasFormulaSolarKW {</P>
<P STYLE="margin-bottom: 0cm">get {</P>
<P STYLE="margin-bottom: 0cm">return this.hasFormulaSolarKW;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula1</P>
<P STYLE="margin-bottom: 0cm">public double Formula1(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula2</P>
<P STYLE="margin-bottom: 0cm">public double Formula2(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula3</P>
<P STYLE="margin-bottom: 0cm">public double Formula3(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula4</P>
<P STYLE="margin-bottom: 0cm">public double Formula4(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an Formula5</P>
<P STYLE="margin-bottom: 0cm">public double Formula5(RowValues
rowValues, SeriesState state) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an FormulaSolarVSG</P>
<P STYLE="margin-bottom: 0cm">public double FormulaSolarVSG(RowValues
rowValues) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}</P>
<P STYLE="margin-bottom: 0cm">/// Calculate an FormulaSolarKW</P>
<P STYLE="margin-bottom: 0cm">public double FormulaSolarKW(RowValues
rowValues) {</P>
<P STYLE="margin-bottom: 0cm">return 0.0;</P>
<P STYLE="margin-bottom: 0cm">}<BR>}</P>
<P STYLE="margin-bottom: 0cm">}</P>
<H4 CLASS="western">Programmier Beispiele:</H4>
<OL>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	rowValues.S17;</FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	rowValues.S04 - rowValues.S12;</FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	(rowValues.S17 == 0) ? 0.0 : </FONT><FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">((1000.0
	/ rowValues.S17) * 3600.0 / RowValues.SolarPulse);</FONT></FONT></FONT></FONT></FONT></P>
	<LI><P><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><FONT COLOR="#000000">if
	(state == SeriesState.First) { iVal1 = 0; dVal1 = 0.0; } iVal1++;
	dVal1 += rowValues.S10; if (state == SeriesState.Last) {
	MessageBox.Show((dVal1 / iVal1).ToString()); } </FONT><FONT COLOR="#0000ff">return</FONT><FONT COLOR="#000000">
	0.0;</FONT></FONT></FONT></P>
</OL>
<P>Information zu den Beispielen:<BR>Im Beispiel 1 wird der Sensor
S17 im Chart gezeichnet.</P>
<P>Im Beispiel 2 wird die Differenz von &bdquo;Heizungspuffer oben&ldquo;
und &bdquo;Vorlauf Heizkreis 1&ldquo; dargestellt.</P>
<P>Im Beispiel 3 wird eine komplexe Formel f&uuml;r den
Solar-Volumenstrom gezeichnet. Zuerst wird der S17 auf 0 gepr&uuml;ft.
Bei Gleichheit wird der Wert zwischen ? und : als return-Wert
zur&uuml;ckgegeben, also 0.0. Ansonsten wird die dahinterstehende
Formel als return-Wert zur&uuml;ckgegeben.<BR>Alternativ kann die
Formel auch folgenderma&szlig;en geschrieben werden:<BR><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">if
</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">(rowValues.S17
== 0) </FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">return</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">0.0;
else </FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">return</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">((1000.0
/ rowValues.S17) * 3600.0 / RowValues.SolarPulse);</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT>
</P>
<P>Beispiel 4 wendet sich an erfahrene Programmierer.<BR>Hier werden
die freien Variablen verwendet. Wie das Beispiel zeigt, sollten am
Beginn einer Serie die verwendeten Variablen initialisiert werden.
Der Sensor S10 wird zum Schluss als Mittelwert des gesamten
Zeitintervalls in einer Messagebox angezeigt.<BR>Es ist weiterhin
m&ouml;glich Funktionen von Klassen zu verwenden, die in System
definiert sind (z.B. Klasse Math mit den Funktionen Abs, Round,
Floor, Ceiling, usw.).</P>
<P>Weiterf&uuml;hrende Dokumentation zu C# z.B. unter:</P>
<P><A HREF="http://msdn.microsoft.com/de-de/library/system.math.aspx">http://msdn.microsoft.com/de-de/library/system.math.aspx</A></P>
<P><A HREF="http://openbook.galileocomputing.de/visual_csharp_2010/">http://openbook.galileocomputing.de/visual_csharp_2010/</A></P>
<H4 CLASS="western">Konfiguration &bdquo;Freie Formeln&ldquo;</H4>
<P>&Uuml;ber Extras-&gt;Konfiguration kann in den Optionen (P06 bis
P10) &uuml;ber Parameter und der &bdquo;&Auml;ndern&ldquo;
Schaltfl&auml;che ein einfacher Formel Editor aufgerufen werden. In
diesem Editor kann die &bdquo;Freie Formel&ldquo; eingegeben werden.</P>
<P><BR><B>Hinweis:</B> Programmierfehler in den freien Formeln werden
in einer &bdquo;Messagebox&ldquo; beim Programmstart oder nach
Konfigurations&auml;nderung angezeigt. Bei Laufzeitfehlern erscheint
unten in der Statusleiste des Programms ein Hinweistext. Es wird dann
nur eine Linie mit 0-Werten gezeichnet. In der Datei StackTrace.txt
(im Verzeichnis der User.config Datei) findet man Fehlerhinweise.</P>
<P><IMG SRC="description_html_9db6fc4.png" NAME="Grafik1" ALIGN=LEFT WIDTH=400 HEIGHT=439 BORDER=0><BR><BR>
</P>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<H2 CLASS="western"><BR><BR>
</H2>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<H2 CLASS="western"><A NAME="FormulaSolar"></A>Formeln f&uuml;r
Solar-Volumenstrom und Solar KW</H2>
<P>Die standardm&auml;&szlig;igen Formeln des Dateityps &bdquo;so*.txt&ldquo;
f&uuml;r die Chart-Darstellung lauten (Programmiersprache C#):</P>
<P>Solar VSG (S17): <FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">return
((1000.0 / rowValues.S17) * 3600.0 / RowValues.SolarPulse);</FONT></FONT></FONT></P>
<P>Solar KW (P02): <BR><FONT COLOR="#0000ff"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">double</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">deltaTemperature
= </FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">rowValues.</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">S05
&ndash; </FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">rowValues.</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">S06;<BR></FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">if</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">((deltaTemperature
&gt; 0) &amp;&amp; (</FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">rowValues.</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">S17
&gt; 0)) {<BR></FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">return</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">deltaTemperature
* rowValues.SolarVSG / 3600.0 * (RowValues.HeatCapacity20 +
(</FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">rowValues.</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">S06
+ (deltaTemperature / 2.0) - 20.0) * 0.004);<BR>}<BR></FONT></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">return</FONT></FONT></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><FONT FACE="Consolas, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">0.0D;</FONT></FONT></FONT></P>
<P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Falls
der Wert von S17 den Wert Null aufweist ist das Ergebnis auch Null.</FONT></FONT></FONT></P>
<P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Mit
dem Konfigurations-Editor m&uuml;ssen beim Sensor S17 bzw. der Option
P02 &uuml;ber den Parameter- Schalter der VSG Pulswert und
m&ouml;glicherweise die spezifische W&auml;rmekapazit&auml;t des
Solarmittels angepasst werden.</FONT></FONT></FONT></P>
<P><IMG SRC="KonfigP02.png" NAME="Grafik8" ALIGN=LEFT WIDTH=396 HEIGHT=370 BORDER=0><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
<P>Diese Formeln sind empirisch ermittelt und k&ouml;nnen in der
Realit&auml;t abweichend sein.</P>
<P>Aus diesem Grund bietet das Programm die M&ouml;glichkeit eigene
Berechnungen f&uuml;r Solar VSG (S17) und Solar KW (P02) f&uuml;r die
Anzeige im Chart zu definieren.<BR>Mit dem Konfigurations-Editor
k&ouml;nnen beim Sensor S17 und bei der Option P02 &uuml;ber den
Parameter- Schalter ein Formeleditor aufgerufen werden. In dem
Formeleditor kann dann die selbstdefinierte Formel eingegeben werden
in der Programmiersprache C# (siehe auch Kapitel &bdquo;Freie
Formeln&ldquo;).</P>
<P>Vielleicht findet jemand korrekte universelle Formeln, in der auch
eine &bdquo;Ost-West Ausrichtung&ldquo; enthalten ist, und teilt
diese dem Forum mit.</P>
<P><B>Hinweis:</B> Da bei der Auswahl die unterschiedlichen
Logdateitypen &bdquo;so*.txt&ldquo; und &bdquo;mi*.txt&ldquo; m&ouml;glich
sind, muss dieses auch in den selbstdefinierten Formeln
ber&uuml;cksichtigt werden. F&uuml;r die Unterscheidung des
ausgew&auml;hlten Dateityps steht das statische Datum
&bdquo;RowValues.SelectedSolvisControlVersion&ldquo; als Integer
Datum zur Verf&uuml;gung. Die Auswahl von &bdquo;so*.txt&ldquo;
Dateien liefert den Wert 131, w&auml;hrend die Auswahl der &bdquo;mi*.txt&ldquo;
Dateien den Wert 132 liefert.</P>
<P>An die Funktion (Formel) wird durch den SolvisSC2Viewer ein
Parameter &uuml;bergeben, bevor der von der Funktion zur&uuml;ckgegebene
Wert im Chart gezeichnet wird. Der Parameter ist die Klasse RowValues
mit dem Bezeichner rowValues. Die Formel muss einen R&uuml;ckgabeparameter
vom Typ double enthalten. Dies wird erreicht durch eine zum Schluss
programmierte Anweisung &bdquo;return xx;&ldquo;, wobei hier xx eine
Variable vom Typ double darstellt.<BR>&Uuml;ber den Bezeichner
rowValues kann lesend auf die Elemente der Klasse zugegriffen werden.
Die Elemente der Klasse sind unter der &Uuml;berschrift &bdquo;Solvis
Logdaten Format&ldquo; genannt. Beispielhafte Programmieranweisungen
sind bei den standardm&auml;&szlig;igen Formeln in diesem Kapitel
genannt.</P>
<H2 CLASS="western"><A NAME="SensorsCheck"></A>Sensoren pr&uuml;fen</H2>
<P>Im Hauptfenster kann unter dem Menupunkt &bdquo;Extras&ldquo; bei
geladener Solvis-Datei der Menupunkt &bdquo;Sensoren pr&uuml;fen&ldquo;
bet&auml;tigt werden. Hierbei wird &uuml;berpr&uuml;ft, ob die
Temperaturf&uuml;hler S01 (Speicher oben) und S04 (Heizungspuffer
oben) korrekt angeschlossen sind. Falls ein Meldungsfenster erscheint
mit dem Meldungstext &bdquo;Temperatur Sensoren S01 und S04
vertauscht&ldquo;, dann ist der Heizungsbetrieb zu rufen. Dieser muss
die Anlage in Ordnung bringen.</P>
<H2 CLASS="western"><A NAME="SDCard"></A>SD-Card Infos</H2>
<P>Unter dem Menupunkt &bdquo;Extras&ldquo; gibt es den Eintrag
&bdquo;SD-Card Infos&ldquo;. In dem Untermenu ist die Anzeige f&uuml;r
den Zeitplan ausw&auml;hlbar. Der Zeitplan beinhaltet tabellarisch
die Zeiteinstellungen der Heizkreise, Zirkulation, Warmwasser und
Eco. Die Information f&uuml;r die Zeiteinstellungen wird aus der
Datei &bdquo;zeitplan.txt&ldquo; entnommen. Optional k&ouml;nnen f&uuml;r
den Zeitplan die Heizkreise 2 und 3 und Eco Zeiten ausgeblendet
werden. Zus&auml;tzlich kann auch das Zeitplan-Fenster als Bild-Datei
namens &bdquo;TimeOverview.png&ldquo; im Dokumentenverzeichnis
(User\&lt;<I>UserName</I>&gt;\Documents\Solvis\SolvisViewer)
gespeichert werden. Die Einstellungen daf&uuml;r werden im
Konfigurations-Editor durchgef&uuml;hrt.<BR>Die Datei
&bdquo;TimeOverview.png&ldquo; kann bei Bedarf mit einem
Standardprogramm f&uuml;r die Bildbetrachtung gedruckt werden.</P>
<P><B>Zum Testen der Anzeige f&uuml;r Z&auml;hlerst&auml;nde und
Parameter</B> kann im Konfigurations-Editor unter SD-Card die
CheckBox &bdquo;Anzeige Parameter, Z&auml;hlstand&ldquo; angew&auml;hlt
werden. Die Dateien paramact.txt und zaehlst.txt m&uuml;ssen im
ausgew&auml;hltem Verzeichnis liegen. Die Parameter und Z&auml;hlerst&auml;nde
k&ouml;nnen auch gedruckt werden. Bei den Parametern werden die
Parameter f&uuml;r Heizkreis 1, Wasser und Zirkulation angezeigt. Die
Parameter f&uuml;r Heizkreis 2 und Heizkreis 3 werden angezeigt, wenn
sie in der Konfiguration unter SD-Card angew&auml;hlt sind.</P>
<P>Wenn korrekte Informationen zu den Dateien zaehlst.txt und
paramact.txt zur Verf&uuml;gung stehen, dann w&auml;ren auch Anzeigen
&uuml;ber Z&auml;hlerstand und Parameter im SolvisSC2Viewer
m&ouml;glich.<BR>Datei zaehlst.txt: Es fehlen die Bedeutungen der
Werte 4 bis 6.<BR>Datei paramact.txt: Es fehlen noch viele Parameter
Bedeutungen (siehe Sourcecode Enums.cs, HeatCircuitSettings,
HeatingSettings.cs, CirculationSettings.cs, WaterSettings.cs und
SolarSettings.cs im Verzeichnis app\system\solvis).</P>
<H2 CLASS="western"><BR><BR>
</H2>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
</BODY>
</HTML>